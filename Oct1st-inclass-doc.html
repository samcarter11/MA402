<html>

<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Title</title>
</head>

<body>

<p>First we have to create a dataframe of the information we want to use in this example.
We will use Household Language, Food Stamp Usage, and Number of People in Household</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># American Community Survey</span>
<span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;data.table&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into 'C:/Users/TORRES_SANT/Documents/R/win-library/3.2'
## (as 'lib' is unspecified)
</pre></div>
<div class="error"><pre class="knitr r">## Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;magrittr&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into 'C:/Users/TORRES_SANT/Documents/R/win-library/3.2'
## (as 'lib' is unspecified)
</pre></div>
<div class="error"><pre class="knitr r">## Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;ggplot2&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into 'C:/Users/TORRES_SANT/Documents/R/win-library/3.2'
## (as 'lib' is unspecified)
</pre></div>
<div class="error"><pre class="knitr r">## Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;dplyr&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into 'C:/Users/TORRES_SANT/Documents/R/win-library/3.2'
## (as 'lib' is unspecified)
</pre></div>
<div class="error"><pre class="knitr r">## Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(data.table)</span>
<span class="hl kwd">library</span><span class="hl std">(magrittr)</span>
<span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
<span class="hl kwd">library</span><span class="hl std">(dplyr)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'dplyr'
## 
## The following objects are masked from 'package:data.table':
## 
##     between, last
## 
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(vcd)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: grid
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">setwd</span><span class="hl std">(</span><span class="hl str">&quot;~/csv_hus&quot;</span><span class="hl std">)</span>
<span class="hl kwd">list.files</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;ACS2013_PUMS_README.pdf&quot; &quot;ss13husa.csv&quot;           
## [3] &quot;ss13husb.csv&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">system.time</span><span class="hl std">({</span>
  <span class="hl com"># var.vec is a list of the variables </span>
  <span class="hl com"># you want to read from the file</span>
  <span class="hl std">var.vec</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'HHL'</span><span class="hl std">,</span><span class="hl str">'FS'</span><span class="hl std">,</span> <span class="hl str">'NP'</span><span class="hl std">)</span>
  <span class="hl std">husa.df</span> <span class="hl kwb">=</span> <span class="hl kwd">fread</span><span class="hl std">(</span><span class="hl str">&quot;ss13husa.csv&quot;</span><span class="hl std">,</span>
                  <span class="hl kwc">stringsAsFactors</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span>
                  <span class="hl kwc">select</span><span class="hl std">=var.vec)</span>
  <span class="hl std">husb.df</span> <span class="hl kwb">=</span> <span class="hl kwd">fread</span><span class="hl std">(</span><span class="hl str">&quot;ss13husb.csv&quot;</span><span class="hl std">,</span>
                  <span class="hl kwc">stringsAsFactors</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span>
                  <span class="hl kwc">select</span><span class="hl std">=var.vec)</span>
  <span class="hl com"># you have created two data frames</span>
<span class="hl std">})</span>
</pre></div>
<div class="output"><pre class="knitr r">## Read 58.2% of 756065 rowsRead 756065 rows and 3 (of 231) columns from 0.574 GB file in 00:00:03
## Read 62.5% of 720248 rowsRead 720248 rows and 3 (of 231) columns from 0.546 GB file in 00:00:03
</pre></div>
<div class="output"><pre class="knitr r">##    user  system elapsed 
##    5.49    0.17    5.68
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Create a single data frame</span>
<span class="hl std">hus.df</span> <span class="hl kwb">=</span> <span class="hl kwd">bind_rows</span><span class="hl std">(husa.df, husb.df)</span>
</pre></div>
</div></div>

<p>Lets take a look at our new datasets</p>
<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#Check values of the HHL (Household language) variable</span>
<span class="hl kwd">table</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">HHL)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
##      1      2      3      4      5 
## 988924 119641  51354  39413  11932
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#Check values of the FS (Yearly Food Stamp) variable</span>
<span class="hl kwd">table</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">FS)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
##       1       2 
##  163693 1195827
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#Check values of the NP (Number of People) variable</span>
<span class="hl kwd">table</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">NP)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
##      0      1      2      3      4      5      6      7      8      9 
## 116793 477927 435903 185131 149688  68014  25954   9381   3983   1813 
##     10     11     12     13     14     15     16     17     18     19 
##    832    384    291     84     47     27     22     11      4      7 
##     20 
##     17
</pre></div>
</div></div>

<p> Not very clear right? Maybe we should add them as factor variables so we know what each set means! </p>
<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Recode as factors</span>
<span class="hl std">HHL.values</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">4</span><span class="hl std">,</span><span class="hl num">5</span><span class="hl std">)</span>
<span class="hl std">HHL.labels</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;English only&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Spanish&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Other Indo-European languages&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Asian and Pacific Island languages&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Other language&quot;</span><span class="hl std">)</span>
<span class="hl std">hus.df</span><span class="hl opt">$</span><span class="hl std">HHL.f</span> <span class="hl kwb">=</span> <span class="hl kwd">factor</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">HHL,</span> <span class="hl kwc">levels</span> <span class="hl std">= HHL.values, HHL.labels)</span>
<span class="hl com">#view summary --- note it has NA values</span>
<span class="hl kwd">summary</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">HHL.f)</span>
</pre></div>
<div class="output"><pre class="knitr r">##                       English only                            Spanish 
##                             988924                             119641 
##      Other Indo-European languages Asian and Pacific Island languages 
##                              51354                              39413 
##                     Other language                               NA's 
##                              11932                             265049
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Recode as factors</span>
<span class="hl std">FS.values</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">)</span>
<span class="hl std">FS.labels</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Yes&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;No&quot;</span><span class="hl std">)</span>
<span class="hl std">hus.df</span><span class="hl opt">$</span><span class="hl std">FS.f</span> <span class="hl kwb">=</span> <span class="hl kwd">factor</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">FS,</span> <span class="hl kwc">levels</span> <span class="hl std">= FS.values, FS.labels)</span>
<span class="hl com">#view summary --- note it has NA values</span>
<span class="hl kwd">summary</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">FS.f)</span>
</pre></div>
<div class="output"><pre class="knitr r">##     Yes      No    NA's 
##  163693 1195827  116793
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Recode as factors</span>
<span class="hl std">NP.values</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">4</span><span class="hl std">,</span><span class="hl num">5</span><span class="hl std">,</span><span class="hl num">6</span><span class="hl std">,</span><span class="hl num">7</span><span class="hl std">,</span><span class="hl num">8</span><span class="hl std">,</span><span class="hl num">9</span><span class="hl std">,</span><span class="hl num">10</span><span class="hl std">,</span><span class="hl num">11</span><span class="hl std">,</span><span class="hl num">12</span><span class="hl std">,</span><span class="hl num">13</span><span class="hl std">,</span><span class="hl num">14</span><span class="hl std">,</span><span class="hl num">15</span><span class="hl std">,</span><span class="hl num">16</span><span class="hl std">,</span><span class="hl num">17</span><span class="hl std">,</span><span class="hl num">18</span><span class="hl std">,</span><span class="hl num">19</span><span class="hl std">,</span><span class="hl num">20</span><span class="hl std">)</span>
<span class="hl std">NP.labels</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Vacant&quot;</span><span class="hl std">,</span><span class="hl str">&quot;1 person&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;2 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;3 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;4 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;5 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;6 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;7 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;8 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;9 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;10 people&quot;</span><span class="hl std">,</span>
              <span class="hl str">&quot;11 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;12 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;13 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;14 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;15 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;16 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;17 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;18 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;19 people&quot;</span><span class="hl std">,</span><span class="hl str">&quot;20 people&quot;</span><span class="hl std">)</span>
<span class="hl std">hus.df</span><span class="hl opt">$</span><span class="hl std">NP.f</span> <span class="hl kwb">=</span> <span class="hl kwd">factor</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">NP,</span> <span class="hl kwc">levels</span> <span class="hl std">= NP.values, NP.labels)</span>
<span class="hl com">#view summary</span>
<span class="hl kwd">summary</span><span class="hl std">(hus.df</span><span class="hl opt">$</span><span class="hl std">NP.f)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    Vacant  1 person  2 people  3 people  4 people  5 people  6 people 
##    116793    477927    435903    185131    149688     68014     25954 
##  7 people  8 people  9 people 10 people 11 people 12 people 13 people 
##      9381      3983      1813       832       384       291        84 
## 14 people 15 people 16 people 17 people 18 people 19 people 20 people 
##        47        27        22        11         4         7        17
</pre></div>
</div></div>

<p> Now that we have this data in an easily viewed format, lets do some analysis! </p>

<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">hus.df</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">ggplot</span>  <span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span>   <span class="hl std">=HHL.f))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_bar</span><span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">fill</span><span class="hl std">=HHL.f))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_fill_brewer</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl std">hus.df</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">mosaic</span><span class="hl std">(</span><span class="hl kwc">formula</span><span class="hl std">=HHL.f</span> <span class="hl opt">~</span> <span class="hl std">NP.f,</span>
         <span class="hl kwc">data</span>   <span class="hl std">=.)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4-2.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl std">hus.df</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">ggplot</span>  <span class="hl std">(</span><span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span>   <span class="hl std">=HHL.f))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_bin2d</span><span class="hl std">(</span><span class="hl kwc">mapping</span>  <span class="hl std">=</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">fill</span><span class="hl std">=HHL.f), NP.f,</span> <span class="hl kwc">data</span> <span class="hl std">= hus.df)</span> <span class="hl opt">+</span> <span class="hl kwd">scale_fill_brewer</span><span class="hl std">()</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in do.call(&quot;layer&quot;, list(mapping = mapping, data = data, stat = stat, : object 'NP.f' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">qplot</span><span class="hl std">(HHL.f,NP.f,</span> <span class="hl kwc">data</span><span class="hl std">=hus.df)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4-3.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div></div>

</body>
</html>









