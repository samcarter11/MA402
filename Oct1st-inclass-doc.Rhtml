<html>

<head>
<title>Title</title>
</head>

<body>

<p>First we have to create a dataframe of the information we want to use in this example.
We will use Household Language, Food Stamp Usage, and Number of People in Household</p>

<!--begin.rcode
# American Community Survey
install.packages("data.table")
install.packages("magrittr")
install.packages("ggplot2")
install.packages("dplyr")
library(data.table)
library(magrittr)
library(ggplot2)
library(dplyr)
library(vcd)

setwd("~/csv_hus")
list.files()

system.time({
  # var.vec is a list of the variables 
  # you want to read from the file
  var.vec = c('HHL','FS', 'NP')
  husa.df = fread("ss13husa.csv", 
                  stringsAsFactors=FALSE,
                  select=var.vec)
  husb.df = fread("ss13husb.csv", 
                  stringsAsFactors=FALSE,
                  select=var.vec)
  # you have created two data frames
})

# Create a single data frame
hus.df = bind_rows(husa.df, husb.df)
end.rcode-->

<p>Lets take a look at our new datasets</p>
<!--begin.rcode
#Check values of the HHL (Household language) variable
table(hus.df$HHL)
#Check values of the FS (Yearly Food Stamp) variable
table(hus.df$FS)
#Check values of the NP (Number of People) variable
table(hus.df$NP)

end.rcode-->

<p> Not very clear right? Maybe we should add them as factor variables so we know what each set means! </p>
<!--begin.rcode
# Recode as factors
HHL.values = c(1,2,3,4,5)
HHL.labels = c("English only", "Spanish", "Other Indo-European languages","Asian and Pacific Island languages", "Other language")
hus.df$HHL.f = factor(hus.df$HHL, levels = HHL.values, HHL.labels)
#view summary --- note it has NA values
summary(hus.df$HHL.f)

# Recode as factors
FS.values = c(1,2)
FS.labels = c("Yes", "No")
hus.df$FS.f = factor(hus.df$FS, levels = FS.values, FS.labels)
#view summary --- note it has NA values
summary(hus.df$FS.f)

# Recode as factors
NP.values = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
NP.labels = c("Vacant","1 person", "2 people","3 people","4 people","5 people","6 people","7 people","8 people","9 people","10 people",
              "11 people","12 people","13 people","14 people","15 people","16 people","17 people","18 people","19 people","20 people")
hus.df$NP.f = factor(hus.df$NP, levels = NP.values, NP.labels)
#view summary
summary(hus.df$NP.f)


end.rcode-->

<p> Now that we have this data in an easily viewed format, lets do some analysis! </p>

<!--begin.rcode fig.width=10, fig.height=6
hus.df %>%
  ggplot  (aes(x   =HHL.f)) +
  geom_bar(aes(fill=HHL.f)) + scale_fill_brewer()

hus.df %>%
  mosaic(formula=HHL.f ~ NP.f, 
         data   =.)

hus.df %>%
  ggplot  (aes(x   =HHL.f)) +
  geom_bin2d(mapping  = aes(fill=HHL.f), NP.f, data = hus.df) + scale_fill_brewer()

qplot(HHL.f,NP.f, data=hus.df)
end.rcode-->

</body>
</html>









